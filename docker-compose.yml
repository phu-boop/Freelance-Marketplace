services:
  # PostgreSQL - Core Database
  postgres:
    image: postgres:16-alpine
    container_name: freelance_postgres
    environment:
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: password
      POSTGRES_DB: freelance_db
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "1.0"

  # Keycloak - IAM
  keycloak:
    image: quay.io/keycloak/keycloak:24.0
    container_name: freelance_keycloak
    environment:
      KC_DB: postgres
      KC_DB_URL: jdbc:postgresql://postgres:5432/keycloak
      KC_DB_USERNAME: admin
      KC_DB_PASSWORD: password
      KEYCLOAK_ADMIN: admin
      KEYCLOAK_ADMIN_PASSWORD: admin
      KC_HOSTNAME_URL: http://localhost:8080
      KC_HOSTNAME_STRICT: "false"
      KC_THEME_CACHE: "false"
    command: start-dev
    ports:
      - "8080:8080"
    volumes:
      - ./keycloak/themes:/opt/keycloak/themes
    depends_on:
      - postgres
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "1.0"

  # Redis - Cache
  redis:
    image: redis:7-alpine
    container_name: freelance_redis
    ports:
      - "6380:6379"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.3"

  # MongoDB - Chat & Notifications
  mongo:
    image: mongo:7
    container_name: freelance_mongo
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: password
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "1.0"

  # Kong - API Gateway (DB-less mode for simplicity initially, or with DB)
  # Using DB-less for quick start, or we can use Postgres. Let's use DB-less for now or standard.
  # For a robust setup, let's use Kong with Postgres (sharing the same instance or a new DB).
  # To keep it simple for MVP startup, let's use Kong in dbless mode or just standard with a prepared DB.
  # Actually, for startup speed, let's use Kong with a declarative config if possible, or just standard.
  # Let's stick to a simple setup: Kong needs a DB migration.
  # For now, I will comment out Kong to avoid complex migration scripts in the first step.
  # We can add Kong later when we have services to route to.

  # Kong - API Gateway (DB-less mode)
  kong:
    image: kong:3.6
    container_name: freelance_kong
    environment:
      KONG_DATABASE: "off"
      KONG_DECLARATIVE_CONFIG: /usr/local/kong/declarative/kong.yml
      KONG_PROXY_ACCESS_LOG: /dev/stdout
      KONG_ADMIN_ACCESS_LOG: /dev/stdout
      KONG_PROXY_ERROR_LOG: /dev/stderr
      KONG_ADMIN_ERROR_LOG: /dev/stderr
      KONG_ADMIN_LISTEN: 0.0.0.0:8001, 0.0.0.0:8444 ssl
      KONG_CLIENT_MAX_BODY_SIZE: 50m
    volumes:
      - ./kong.yml:/usr/local/kong/declarative/kong.yml
    ports:
      - "8000:8000"
      - "8443:8443"
      - "127.0.0.1:8001:8001"
      - "127.0.0.1:8444:8444"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # User Service
  user-service:
    build:
      context: ./services/user-service
      dockerfile: Dockerfile
    container_name: freelance_user_service
    ports:
      - "3001:3000"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=users
      - PORT=3000
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_ADMIN_USER=admin
      - KEYCLOAK_ADMIN_PASSWORD=admin
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - KEYCLOAK_CLIENT_ID=freelance-client
      - SEARCH_SERVICE_URL=http://search-service:3010
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/user-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m  # Tăng lên ít nhất 512m
          cpus: "0.5"   # Có thể tăng nhẹ CPU để khởi động nhanh hơn
        reservations:
          memory: 2048m  # Đảm bảo hệ thống luôn dành ra 256m cho Kong
  # Job Service
  job-service:
    build:
      context: ./services/job-service
      dockerfile: Dockerfile
    container_name: freelance_job_service
    ports:
      - "3002:3002"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=jobs&options=-c%20search_path%3Djobs
      - PORT=3002
      - SEARCH_SERVICE_URL=http://search-service:3010
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_CLIENT_ID=freelance-client
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - USER_SERVICE_INTERNAL_URL=http://user-service:3000/api/users
      - EMAIL_SERVICE_INTERNAL_URL=http://email-service:3012
      - ANALYTICS_SERVICE_URL=http://analytics-service:3014
      - GEMINI_API_KEY=YOUR_GEMINI_API_KEY_HERE
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/job-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Proposal Service
  proposal-service:
    build:
      context: ./services/proposal-service
      dockerfile: Dockerfile
    container_name: freelance_proposal_service
    ports:
      - "3003:3003"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=proposals&options=-c%20search_path%3Dproposals
      - PORT=3003
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_CLIENT_ID=freelance-client
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - JOB_SERVICE_URL=http://job-service:3002/api/jobs
      - USER_SERVICE_URL=http://user-service:3000/api/users
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/proposal-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Contract Service
  contract-service:
    build:
      context: ./services/contract-service
      dockerfile: Dockerfile
    container_name: freelance_contract_service
    ports:
      - "3004:3004"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=contracts&options=-c%20search_path%3Dcontracts
      - PORT=3004
      - PAYMENT_SERVICE_URL=http://payment-service:3005
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_CLIENT_ID=freelance-client
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/contract-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Chat Service
  chat-service:
    build:
      context: ./services/chat-service
      dockerfile: Dockerfile
    container_name: freelance_chat_service
    ports:
      - "3006:3006"
    environment:
      - MONGODB_URI=mongodb://admin:password@mongo:27017/freelance_chat?authSource=admin
      - PORT=3006
      - NODE_OPTIONS=--max-old-space-size=1536
    depends_on:
      - mongo
    volumes:
      - ./services/chat-service:/app
      - /app/node_modules
    command: sh -c "npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Notification Service
  notification-service:
    build:
      context: ./services/notification-service
      dockerfile: Dockerfile
    container_name: freelance_notification_service
    ports:
      - "3007:3007"
    environment:
      - MONGODB_URI=mongodb://admin:password@mongo:27017/freelance_notifications?authSource=admin
      - PORT=3007
      - NODE_OPTIONS=--max-old-space-size=1536
    depends_on:
      - mongo
    volumes:
      - ./services/notification-service:/app
      - /app/node_modules
    command: sh -c "npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Review Service
  review-service:
    build:
      context: ./services/review-service
      dockerfile: Dockerfile
    container_name: freelance_review_service
    ports:
      - "3008:3008"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=reviews&options=-c%20search_path%3Dreviews
      - PORT=3008
      - USER_SERVICE_INTERNAL_URL=http://user-service:3000/api/users
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_CLIENT_ID=freelance-client
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/review-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Admin Service
  admin-service:
    build:
      context: ./services/admin-service
      dockerfile: Dockerfile
    container_name: freelance_admin_service
    ports:
      - "3009:3009"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=admin&options=-c%20search_path%3Dadmin
      - PORT=3009
      - JOB_SERVICE_URL=http://job-service:3002
      - USER_SERVICE_URL=http://user-service:3000
      - PAYMENT_SERVICE_URL=http://payment-service:3005
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_CLIENT_ID=freelance-client
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/admin-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Search Service
  search-service:
    build:
      context: ./services/search-service
      dockerfile: Dockerfile
    container_name: freelance_search_service
    ports:
      - "3010:3010"
    environment:
      - ELASTICSEARCH_NODE=http://elasticsearch:9200
      - PORT=3010
      - USER_SERVICE_INTERNAL_URL=http://user-service:3000
      - NODE_OPTIONS=--max-old-space-size=1536
    depends_on:
      - elasticsearch
    volumes:
      - ./services/search-service:/app
    command: sh -c "npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Community Service
  community-service:
    build:
      context: ./services/community-service
      dockerfile: Dockerfile
    container_name: freelance_community_service
    ports:
      - "3015:3015"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=community&options=-c%20search_path%3Dcommunity
      - PORT=3015
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_CLIENT_ID=freelance-client
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/community-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Elasticsearch
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.12.0
    container_name: freelance_elasticsearch
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - cluster.routing.allocation.disk.threshold_enabled=false
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    ports:
      - "9200:9200"
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 1g
          cpus: "1.5"

  # Kibana
  kibana:
    image: docker.elastic.co/kibana/kibana:8.12.0
    container_name: freelance_kibana
    environment:
      - ELASTICSEARCH_HOSTS=http://elasticsearch:9200
    ports:
      - "5601:5601"
    depends_on:
      - elasticsearch
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "1.0"

  # Analytics Service
  analytics-service:
    build:
      context: ./services/analytics-service
      dockerfile: Dockerfile
    container_name: freelance_analytics_service
    ports:
      - "3014:3014"
    environment:
      - CLICKHOUSE_HOST=clickhouse
      - CLICKHOUSE_PORT=8123
      - CLICKHOUSE_USER=admin
      - CLICKHOUSE_PASSWORD=password
      - CLICKHOUSE_DB=freelance_analytics
      - PORT=3014
    depends_on:
      - clickhouse
    volumes:
      - ./services/analytics-service:/app
    command: sh -c "until python -c 'import urllib.request; urllib.request.urlopen(\"http://clickhouse:8123/ping\")'; do echo 'Waiting for ClickHouse...'; sleep 3; done && uvicorn app.main:app --host 0.0.0.0 --port 3014 --reload"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"
  clickhouse:
    image: clickhouse/clickhouse-server:23.8
    container_name: freelance_clickhouse
    ports:
      - "8123:8123"
      - "9002:9000"
    environment:
      - CLICKHOUSE_DB=freelance_analytics
      - CLICKHOUSE_USER=admin
      - CLICKHOUSE_PASSWORD=password
    ulimits:
      nofile:
        soft: 262144
        hard: 262144
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 1g
          cpus: "1.0"
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:8123/ping"]
      interval: 10s
      timeout: 5s
      retries: 10
      start_period: 10s

  # Payment Service
  payment-service:
    build:
      context: ./services/payment-service
      dockerfile: Dockerfile
    container_name: freelance_payment_service
    ports:
      - "3005:3005"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=payments&options=-c%20search_path%3Dpayments
      - PORT=3005
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_CLIENT_ID=freelance-client
      - KEYCLOAK_SECRET=xwI5XqQWUNSJLtQ6g9IbSbJsjgK0U6M3
      - ADMIN_SERVICE_URL=http://admin-service:3009
      - AUDIT_SERVICE_URL=http://audit-service:3011
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/payment-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  audit-service:
    build:
      context: ./services/audit-service
      dockerfile: Dockerfile
    container_name: freelance_audit_service
    ports:
      - "3011:3011"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=audit&options=-c%20search_path%3Daudit
      - PORT=3011
      - AUDIT_SECRET=super-secret-integrity-key
      - NODE_OPTIONS=--max-old-space-size=1536
    depends_on:
      - postgres
    volumes:
      - ./services/audit-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # MinIO - Object Storage (S3 Compatible)
  minio:
    image: minio/minio
    container_name: freelance_minio
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      MINIO_ROOT_USER: admin
      MINIO_ROOT_PASSWORD: password
    command: server /data --console-address ":9001"
    volumes:
      - minio_data:/data
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Mailhog - Email Testing
  mailhog:
    image: mailhog/mailhog
    container_name: freelance_mailhog
    ports:
      - "1025:1025" # SMTP port
      - "8025:8025" # Web UI
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.3"

  # Email Service
  email-service:
    build:
      context: ./services/email-service
      dockerfile: Dockerfile
    container_name: freelance_email_service
    ports:
      - "3012:3012"
    environment:
      - PORT=3012
      - EMAIL_USER=user@example.com
      - EMAIL_PASS=password
      - SMTP_HOST=mailhog
      - SMTP_PORT=1025
      - NODE_OPTIONS=--max-old-space-size=1536
    volumes:
      - ./services/email-service:/app
    command: sh -c "npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Storage Service
  storage-service:
    build:
      context: ./services/storage-service
      dockerfile: Dockerfile
    container_name: freelance_storage_service
    ports:
      - "3018:3018"
    environment:
      - PORT=3018
      - MINIO_ENDPOINT=minio
      - MINIO_PORT=9000
      - MINIO_ACCESS_KEY=admin
      - MINIO_SECRET_KEY=password
      - MINIO_EXTERNAL_URL=http://localhost:9000
      - NODE_OPTIONS=--max-old-space-size=1536
    depends_on:
      - minio
    volumes:
      - ./services/storage-service:/app
    command: sh -c "npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Common Service
  common-service:
    build:
      context: ./services/common-service
      dockerfile: Dockerfile
    container_name: freelance_common_service
    ports:
      - "3013:3013"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=common&options=-c%20search_path%3Dcommon
      - PORT=3013
      - NODE_OPTIONS=--max-old-space-size=1536
    depends_on:
      - postgres
    volumes:
      - ./services/common-service:/app
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Frontend
  # frontend:
  #   build:
  #     context: ./frontend
  #     dockerfile: Dockerfile
  #   container_name: freelance_frontend
  #   ports:
  #     - "3000:3000"
  #   environment:
  #     - NEXT_PUBLIC_KEYCLOAK_URL=http://localhost:8080
  #     - NEXT_PUBLIC_KEYCLOAK_REALM=freelance-marketplace
  #     - NEXT_PUBLIC_KEYCLOAK_CLIENT_ID=freelance-frontend
  #     - NEXT_PUBLIC_API_URL=http://localhost:8000/api
  #   depends_on:
  #     - keycloak
  #     - kong
  #     - user-service
  #     - job-service
  #   volumes:
  #     - ./frontend:/app
  #     - /app/node_modules
  #     - /app/.next
  #   command: npm run dev
  #   restart: always
  #   networks:
  #     - freelance_network
  # Developer Service
  developer-service:
    build:
      context: ./services/developer-service
      dockerfile: Dockerfile
    container_name: freelance_developer_service
    ports:
      - "3016:3016"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=developer&options=-c%20search_path%3Ddeveloper
      - PORT=3016
      - KEYCLOAK_URL=http://localhost:8080
      - KEYCLOAK_REALM=freelance-marketplace
      - KEYCLOAK_ADMIN_USER=admin
      - KEYCLOAK_ADMIN_PASSWORD=admin
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
      - keycloak
    volumes:
      - ./services/developer-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

  # Talent Cloud Service
  talent-cloud-service:
    build:
      context: ./services/talent-cloud-service
      dockerfile: Dockerfile
    container_name: freelance_talent_cloud_service
    ports:
      - "3017:3017"
    environment:
      - DATABASE_URL=postgresql://admin:password@postgres:5432/freelance_db?schema=talent_clouds&options=-c%20search_path%3Dtalent_clouds
      - PORT=3017
      - USER_SERVICE_URL=http://user-service:3000
      - NODE_OPTIONS=--max-old-space-size=1536
    extra_hosts:
      - "localhost:host-gateway"
    depends_on:
      - postgres
    volumes:
      - ./services/talent-cloud-service:/app
      - /app/node_modules
    command: sh -c "npx prisma@6.1.0 generate && npm run start:dev"
    restart: always
    networks:
      - freelance_network
    deploy:
      resources:
        limits:
          memory: 2048m
          cpus: "0.5"

networks:
  freelance_network:
    driver: bridge

volumes:
  postgres_data:
  mongo_data:
  elasticsearch_data:
  minio_data:
